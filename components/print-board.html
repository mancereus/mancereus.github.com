<link rel="import" href="../lib/polymer/polymer.html">
<link rel="import" href="game-card.html">

<polymer-element name="print-board" attributes="cards width"  on-show-card="{{showCard}}">
<template>
  <style>
    :host {
      display: block;
    }
    game-card {
      margin: 3px;
    }
  </style>

  <div id="gameTable" layout horizontal wrap center > <!--style="padding-top: 220px">-->
    <template repeat="{{ card, cardIndex in cards}}">
    <!--  <template if="{{ card.imgclass}}">
        <game-piece style="margin: 2px;" img="../img/{{card.name}}.png" imgclass="{{card.imgclass}}"></game-piece>
    </template> -->
      <game-card horiz="{{card.hor}}" selected="1" vertic="{{card.ver}}" symbol="{{card.imgclass}}" imgSrc="{{card.name}}" titleText="{{card.name}}" text="{{card.Aktion}}" cardData="{{card}}" > 

    </game-card>
      <template if="{{ (cardIndex+1) % 9 == 0 }}">
      <div class="pagebreak" style="height: 88px;width: 600px;">page-break</div>
      </template>
  </template>
</div>
</template>
<script>
 var initcards =  [
 {name: "Heissluftballon", color : "H", imgclass:"symbol", akt: "3", Aktion: "Ihr findet einen alten Heissluftballon. Er scheint noch zu funktionieren, hat aber keine Luft.", warn:"Boot", bgc:"blue"},
 {name: "Ureinwohner", akt: "3", Aktion: "Die Ureinwohner durchstreifen das Tal. Ihr könnt euch vorbeischleichen, wenn auf jeder Inventarkarte nur 1 Gegenstand liegt. Sonst fangen und töten Sie euch.", warn:"Edelstein"},
 {name: "Ureinwohner", akt: "3", Aktion: "Die Ureinwohner durchstreifen das Tal. Ihr könnt euch vorbeischleichen, wenn auf jeder Inventarkarte nur 1 Gegenstand liegt. Sonst fangen und töten Sie euch.", warn:"Edelstein", pagebreak: "pagebreak"},
 {name: "Ureinwohner", akt: "3", Aktion: "Die Ureinwohner durchstreifen das Tal. Ihr könnt euch vorbeischleichen, wenn auf jeder Inventarkarte nur 1 Gegenstand liegt. Sonst fangen und töten Sie euch.", warn:"Edelstein"},
 {name: "Ureinwohner", akt: "3", Aktion: "Die Ureinwohner durchstreifen das Tal. Ihr könnt euch vorbeischleichen, wenn auf jeder Inventarkarte nur 1 Gegenstand liegt. Sonst fangen und töten Sie euch.", warn:"Edelstein"},
 {name: "Weg", level: "normal", Aktion: "",flavour: "Jack: 'Pause.'",ver: "true",hor: "true"},
 {name: "Fels", level: "normal", Aktion: "Du kannst dieses Feld nicht betreten und nicht mit der Liane überfliegen."},
 {name: "Fels", level: "normal", Aktion: "Du kannst dieses Feld nicht betreten und nicht mit der Liane überfliegen."},

];
 var initActions = [
 {name: "Ureinwohner", akt: "3a", Aktion: "Der Großwildjäger wurde von den Ureinwohner getötet. Falls Jane gefangen wurde, soll Sie als nächstes sterben. Nur wenn du das Idol abgibst oder Gura Gora besiegst, lassen Sie Jane frei. Die Ureinwohner lassen euch nun ungehindert vorbeiziehen.", bgc:"orange", win:"Fluss", bgcwin:"blue",task: true},
 {name: "Ureinwohner", akt: "3a", color : "H", Aktion: "Jane hat die Ureinwohner überzeugt, dass ihre friedliche Absichten habt. Falls sie Jane gefangen hielten, kommt Sie nun mit dir mit. Die Ureinwohner lassen euch nun überall ungehindert vorbeiziehen.", win:"Jane2", bgcwin:"green", task: true},
 {name: "Ureinwohner", akt: "3a", color : "H", Aktion: "Die Ureinwohner sehen in Jane die Inkarnation einer Göttin. Falls Jane gefangen wurde, ist sie nun mit Kostüm und Goldschmuck bekleidet. Mit Dynamit oder Pistole kannst du Sie befreien.", win:"Jane2", bgcwin:"green", task: true},
 {name: "Gura Gora", akt: "3", Aktion: "Die Ureinwohner werden vom Affendämon Gura Gora zu Menschenopfern gezwungen. Er hat euch entdeckt. Nach jedem Zug zieht Gura Gora 1 Feld waagrecht oder senkrecht in eure Richtung. Wenn er euch erreicht, tötet er euch.",win:"Fluss", bgcwin:"blue", warn:"Jane2", bgc:"orange", imgclass:"symbol", task: true},
 {name: "Prof Hampton", akt: "3c", order: "4", Aktion: "Janes Vater hat sich in einer Höhle vor Gura Gora versteckt. Wenn du ihm beide Kugeln bringst, verlässt er mit euch das Tal.", imgclass:"symbol", task: true},
 {name: "Prof Hampton", akt: "3c", order: "4", Aktion: "Janes Vater hat sich in einer Höhle vor Gura Gora versteckt. Er ist seinen Verletzungen erlegen, und vor 2 Tagen gestorben. Er hat Jane einen Abschiedsbrief hinterlassen. Jane weint bitterlich in Jacks Armen.", imgclass:"symbol", task: true},
 {name: "Prof Hampton", akt: "3c", order: "4", Aktion: "Janes Vater hat sich in einer Höhle vor Gura Gora versteckt. Er ist völlig entkräftet. Er kommt mit euch, muss aber getragen werden und kann selbst keine Gegenstände tragen.", imgclass:"symbol", task: true},
 {name: "Fluss", akt: "3d", Aktion: "Jack, Jane und Prof. Hampton können mit dem Boot am Fluss das Abenteuer erfolgreich beenden.", bgc:"orange", win:"Fluss", bgcwin:"blue",task: true},
 {name: "Heisse Quelle", akt: "3d", Aktion: "Ihr könnt den Heissluftballon hier mit heisser Luft füllen. Jack, Jane und Prof. Hampton können das Abenteuer hier erfolgreich beenden. Ihr fliegt mit dem Ballon aus dem versteckten Tal in die Freiheit.", bgc:"orange", win:"Fluss", bgcwin:"blue",task: true},
 {name: "Schatzkammer", akt: "3d", Aktion: "Ihr habt die goldene Schatz-kammer der Ureinwohner gefunden. Mit den beiden Kugeln öffnet ihr hier ein Portal, dass euch aus dem Dschungel teleportiert. Jack, Jane und Prof. Hampton können das Abenteuer hier erfolgreich beenden.", bgc:"orange", win:"Fluss", bgcwin:"blue",task: true}
 ];
</script>
<!-- <script src="../js/base.js"></script>
  <script>        var initcards=[];</script>
  <script src="../js/data3.js"></script>
 <script>        initcards.push.apply(initcards,actcards);</script> -->
<!--
<script src="../js/data2.js"></script>
<script>        initcards.push.apply(initcards,actcards);</script>
<script src="../js/data3.js"></script>
<script>        initcards.push.apply(initcards,actcards);</script>
 -->
<!--<script src="../js/data1.js"></script>
<script>        initcards.push.apply(initcards,initActions);</script>
<script src="../js/data2.js"></script>
<script>        initcards.push.apply(initcards,initActions);</script>
<script src="../js/data3.js"></script>-->
<script>        initcards.push.apply(initcards,initActions);</script>
<!--<script>        initcards.push(start);</script> -->
<script>
  StopIteration = function () {};
  StopIteration.prototype = new Error();
  StopIteration.name = 'StopIteration';
  StopIteration.message = 'StopIteration';

  arrayLikeIterator = function (arrayLike) {
    var i = 0;
    return {
      'next': function () {
        if (i >= arrayLike.length) {
          throw StopIteration;
        }
        return arrayLike[i++];
      }
    };
  };
  function shuffle(o){ 
    for(var j, x, i = o.length; i; j = Math.floor(Math.random() * i), x = o[--i], o[i] = o[j], o[j] = x);
      return o;
  };
  Array.prototype.contains = function(obj) {
    var i = this.length;
    while (i--) {
      if (this[i] === obj) {
        return true;
      }
    }
    return false;
  };
  Polymer('print-board', {
      // initialize the element's model
      width: "1480px",
      created: function() {

        var actions = initActions;
        this.cards = initcards;
      },
      ready: function() {
          this.style.width = this.width;
      },
      domReady: function() {
          var items = this.$.gameTable.children;
          var i = items.length;

          while(i--) {
            if (items[i].tagName === "DIV") {
              items[i].style.pageBreakBefore="always";
              items[i].style.pageBreakAfter="always";
            }
          }

      },
      openCard:  function(idx) {
        var open = [2,7,12];
        if (open.contains(idx))
          return 1;
        return 0;
      }
    });
</script>

</polymer-element>